import Head from 'next/head';

import fetchStandings from './api/fetchStandings';
import fetchFixtures from './api/fetchFixtures';
import Standings from '../components/Standings';
import Game from '../components/Game';

const Home = ({ standings, fixtures }: { standings: [string, any][]; fixtures: Object }) => {
	return (
		<div>
			<Head>
				<title>Score Prediction</title>
				<meta name="description" content="Generated by create next app" />
				<link rel="icon" href="/favicon.ico" />
			</Head>

			<main className="bg-dark min-h-screen flex flex-col justify-center select-none">
				<h1 className="text text-6xl w-full text-center text-light">Score Prediction</h1>

				{Object.values(fixtures).map(game => (
					<Game game={game} key={game.fixture.id} />
				))}

				<Standings standings={standings} />
			</main>
		</div>
	);
};

export const getServerSideProps = async () => {
	try {
		const standings = await fetchStandings();
		const fixtures = await fetchFixtures();

		const sorted = Object.entries(standings).sort();

		return {
			props: {
				standings: sorted,
				fixtures,
			},
		};
	} catch (e) {
		return {
			props: { standings: [], fixtures: {} },
		};
	}
};

export default Home;
